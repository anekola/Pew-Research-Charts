(function(e){function t(e){var t=[0,0,0,0,0,0],n=0,r=[];for(a=e.length;n<a;n++){if(e[n]["x"]){e[n][0]=e[n]["x"];e[n][1]=e[n]["y"]}if(e[n][1]){t[0]+=e[n][0];t[1]+=e[n][1];t[2]+=e[n][0]*e[n][0]*e[n][1];t[3]+=e[n][1]*Math.log(e[n][1]);t[4]+=e[n][0]*e[n][1]*Math.log(e[n][1]);t[5]+=e[n][0]*e[n][1]}}var i=t[1]*t[2]-t[5]*t[5];var s=Math.pow(Math.E,(t[2]*t[3]-t[5]*t[4])/i);var o=(t[1]*t[4]-t[5]*t[3])/i;for(var u=0,a=e.length;u<a;u++){var f=[e[u][0],s*Math.pow(Math.E,o*e[u][0])];r.push(f)}r.sort(function(e,t){if(e[0]>t[0]){return 1}if(e[0]<t[0]){return-1}return 0});var l="y = "+Math.round(s*100)/100+"e^("+Math.round(o*100)/100+"x)";return{equation:[s,o],points:r,string:l}}function n(e){var t=[0,0,0,0,0],n=0,r=[],i=e.length;for(;n<e.length;n++){if(e[n]["x"]){e[n][0]=e[n]["x"];e[n][1]=e[n]["y"]}if(e[n][1]){t[0]+=e[n][0];t[1]+=e[n][1];t[2]+=e[n][0]*e[n][0];t[3]+=e[n][0]*e[n][1];t[4]+=e[n][1]*e[n][1]}}var s=(n*t[3]-t[0]*t[1])/(n*t[2]-t[0]*t[0]);var o=t[1]/n-s*t[0]/n;for(var u=0,a=e.length;u<a;u++){var f=[e[u][0],e[u][0]*s+o];r.push(f)}r.sort(function(e,t){if(e[0]>t[0]){return 1}if(e[0]<t[0]){return-1}return 0});var l="y = "+Math.round(s*100)/100+"x + "+Math.round(o*100)/100;return{equation:[s,o],points:r,string:l}}function r(e){var t=[0,0,0,0],n=0,r=[],i=0;for(a=e.length;n<a;n++){if(e[n]["x"]){e[n][0]=e[n]["x"];e[n][1]=e[n]["y"]}if(e[n][1]){t[0]+=Math.log(e[n][0]);t[1]+=e[n][1]*Math.log(e[n][0]);t[2]+=e[n][1];t[3]+=Math.pow(Math.log(e[n][0]),2)}}var s=(n*t[1]-t[2]*t[0])/(n*t[3]-t[0]*t[0]);var o=(t[2]-s*t[0])/n;for(var u=0,a=e.length;u<a;u++){var f=[e[u][0],o+s*Math.log(e[u][0])];r.push(f)}r.sort(function(e,t){if(e[0]>t[0]){return 1}if(e[0]<t[0]){return-1}return 0});var l="y = "+Math.round(o*100)/100+" + "+Math.round(s*100)/100+" ln(x)";return{equation:[o,s],points:r,string:l}}function i(e){var t=[0,0,0,0],n=0,r=[];for(u=e.length;n<u;n++){if(e[n]["x"]){e[n][0]=e[n]["x"];e[n][1]=e[n]["y"]}if(e[n][1]){t[0]+=Math.log(e[n][0]);t[1]+=Math.log(e[n][1])*Math.log(e[n][0]);t[2]+=Math.log(e[n][1]);t[3]+=Math.pow(Math.log(e[n][0]),2)}}var i=(n*t[1]-t[2]*t[0])/(n*t[3]-t[0]*t[0]);var s=Math.pow(Math.E,(t[2]-i*t[0])/n);for(var o=0,u=e.length;o<u;o++){var a=[e[o][0],s*Math.pow(e[o][0],i)];r.push(a)}r.sort(function(e,t){if(e[0]>t[0]){return 1}if(e[0]<t[0]){return-1}return 0});var f="y = "+Math.round(s*100)/100+"x^"+Math.round(i*100)/100;return{equation:[s,i],points:r,string:f}}function s(e,t){if(typeof t=="undefined"){t=2}var n=[],r=[],i=[],s=0,o=0,a=0,f=t+1;for(;a<f;a++){for(var l=0,c=e.length;l<c;l++){if(e[l]["x"]){e[l][0]=e[l]["x"];e[l][1]=e[l]["y"]}if(e[l][1]){s+=Math.pow(e[l][0],a)*e[l][1]}}n.push(s),s=0;var h=[];for(var p=0;p<f;p++){for(var l=0,c=e.length;l<c;l++){if(e[l][1]){o+=Math.pow(e[l][0],a+p)}}h.push(o),o=0}r.push(h)}r.push(n);var d=u(r,f);for(var a=0,c=e.length;a<c;a++){var v=0;for(var m=0;m<d.length;m++){v+=d[m]*Math.pow(e[a][0],m)}i.push([e[a][0],v])}i.sort(function(e,t){if(e[0]>t[0]){return 1}if(e[0]<t[0]){return-1}return 0});var g="y = ";for(var a=d.length-1;a>=0;a--){if(a>1)g+=Math.round(d[a]*100)/100+"x^"+a+" + ";else if(a==1)g+=Math.round(d[a]*100)/100+"x"+" + ";else g+=Math.round(d[a]*100)/100}return{equation:d,points:i,string:g}}function o(e,t){function s(e){var t={},n,r=e.length,i=[];for(n=0;n<r;n+=1)t[e[n]]=e[n];for(n in t)i.push(t[n]);return i}function o(e){var t=1-e*e*e;return t*t*t}var t=t||.25;var n=e.map(function(e){return e[0]});var r=s(n);if(2/r.length>t){t=Math.min(2/r.length,1);console.warn("updated bandwith to "+t)}var i=e.map(function(e){return e[1]});var u=[];var a=0;var f=Math.floor(t*n.length)-1;for(var l in n){var c=n[l];if(l>0){if(f<n.length-1&&n[f+1]-n[l]<n[l]-n[a]){a++;f++}}var h;if(n[l]-n[a]>n[f]-n[l])h=a;else h=f;var p=Math.abs(1/(n[h]-c));var d=0;var v=0,m=0,g=0,y=0;var b=a;while(b<=f){var w=n[b];var E=i[b];var S;if(b<l){S=c-w}else{S=w-c}var x=o(S*p);var T=w*x;d+=x;v+=T;m+=w*T;g+=E*x;y+=E*T;b++}var N=v/d;var C=g/d;var k=y/d;var L=m/d;var A;if(L==N*N)A=0;else A=(k-N*C)/(L-N*N);var O=C-A*N;u[l]=A*c+O}console.debug(u);return{equation:"",points:n.map(function(e,t){return[e,u[t]]}),string:""}}function u(e,t){var n=0,r=0,i=0,s=0,o=0,u=e.length-1,a=new Array(t);for(n=0;n<u;n++){s=n;for(r=n+1;r<u;r++){if(Math.abs(e[n][r])>Math.abs(e[n][s]))s=r}for(i=n;i<u+1;i++){o=e[i][n];e[i][n]=e[i][s];e[i][s]=o}for(r=n+1;r<u;r++){for(i=u;i>=n;i--){e[i][r]-=e[i][n]*e[n][r]/e[n][n]}}}for(r=u-1;r>=0;r--){o=0;for(i=r+1;i<u;i++)o+=e[i][r]*a[i];a[r]=(e[u][r]-o)/e[r][r]}return a}function a(e,t){var n=SSE=SSYY=mean=0;for(n=0;n<e.length;n++){mean+=e[n][1]/e.length}for(n=0;n<e.length;n++){SSYY+=Math.pow(e[n][1]-t[n][1],2);SSE+=Math.pow(e[n][1]-mean,2)}return 1-SSYY/SSE}e.wrap(e.Chart.prototype,"init",function(e){var i=arguments[1].series;var u=[];var f=0;for(f=0;f<i.length;f++){var l=i[f];if(l.regression&&!l.rendered){l.regressionSettings=l.regressionSettings||{};var c=l.regressionSettings.type||"linear";var h;var p={data:[],color:l.color,yAxis:l.yAxis,lineWidth:2,marker:{enabled:false},isRegressionLine:true,name:l.regressionSettings.label||"Equation: %eq",color:l.regressionSettings.color||""};p.type="spline";if(c=="linear"){h=n(l.data);p.type="line"}else if(c=="exponential"){h=t(l.data)}else if(c=="polynomial"){h=s(l.data,2)}else if(c=="logarithmic"){h=r(l.data)}else if(c=="loess"){var d=l.regressionSettings.loessSmooth||25;h=o(l.data,d/100)}else{console.error("Invalid regression type: ",c);break}h.rSquared=a(l.data,h.points).toFixed(2);h.rValue=Math.sqrt(h.rSquared,2).toFixed(2);p.data=h.points;p.name=p.name.replace("%r2",h.rSquared);p.name=p.name.replace("%r",h.rValue);p.name=p.name.replace("%eq",h.string);p.regressionOutputs=h;u.push(p);arguments[1].series[f].rendered=true}}arguments[1].series=i.concat(u);e.apply(this,Array.prototype.slice.call(arguments,1))})})(Highcharts)